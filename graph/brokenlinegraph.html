<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•Œê¸° ì‰¬ìš´ êº¾ì€ì„  ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</title>
    <!-- ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê¸° ìœ„í•œ Chart.js ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¸í„°ë„·ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ì „ì²´ í˜ì´ì§€ ë””ìì¸ */
        body {
            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
            background-color: #f0f8ff; /* í•˜ëŠ˜ìƒ‰ ë°°ê²½ */
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        /* ì „ì²´ë¥¼ ê°ì‹¸ëŠ” ìƒì */
        .container {
            max-width: 900px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* ì œëª© ìŠ¤íƒ€ì¼ */
        h1 {
            color: #005a9c;
            text-align: center;
            margin-bottom: 20px;
        }

        /* ì…ë ¥ ë¶€ë¶„ê³¼ ê·¸ë˜í”„ ë¶€ë¶„ì„ ë‚˜ëˆ” */
        .input-section, .output-section {
            margin-top: 30px;
        }

        /* ì‘ì€ ì œëª©ë“¤ (ì˜ˆ: ê·¸ë˜í”„ ì •ë³´, ë°ì´í„° ì…ë ¥) */
        h2 {
            color: #0077cc;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 5px;
            margin-top: 20px;
        }

        /* ì…ë ¥ì°½ ê·¸ë£¹ */
        .input-group {
            margin-bottom: 15px;
        }

        /* ì…ë ¥ì°½ ë¼ë²¨ (ì„¤ëª… ê¸€ì”¨) */
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        /* í…ìŠ¤íŠ¸ ì…ë ¥ì°½ */
        input[type="text"], input[type="number"] {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        /* í‘œ ë””ìì¸ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #eaf6ff;
        }

        /* í‘œ ì•ˆì˜ ì…ë ¥ì°½ */
        td input {
            width: 90%;
            text-align: center;
            border: none;
            background-color: transparent;
        }
        td input:focus {
            outline: 1px solid #0077cc;
        }
        
        /* ë²„íŠ¼ë“¤ì„ ë‹´ëŠ” ìƒì */
        .button-group {
            display: flex;
            gap: 10px; /* ë²„íŠ¼ ì‚¬ì´ ê°„ê²© */
            margin-top: 15px;
        }

        /* ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        button {
            background-color: #0077cc;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        button:hover {
            background-color: #005a9c;
            transform: scale(1.05); /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì‚´ì§ ì»¤ì§ */
        }

        /* ì´ˆë¡ìƒ‰ ë²„íŠ¼ */
        .btn-green {
            background-color: #28a745;
        }
        .btn-green:hover {
            background-color: #218838;
        }

        /* ë¹¨ê°„ìƒ‰ ë²„íŠ¼ */
        .btn-red {
            background-color: #dc3545;
        }
        .btn-red:hover {
            background-color: #c82333;
        }
        
        /* ê·¸ë˜í”„ê°€ ê·¸ë ¤ì§ˆ ìº”ë²„ìŠ¤ */
        #myChart {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ“Š ì•Œê¸° ì‰¬ìš´ êº¾ì€ì„  ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</h1>
        <p>ê·¸ë˜í”„ ì œëª©ê³¼ ê° ì¶•ì˜ ì´ë¦„ì„ ì“°ê³ , í‘œì— ë°ì´í„°ë¥¼ ì…ë ¥í•œ ë’¤ 'ê·¸ë˜í”„ ê·¸ë¦¬ê¸°!' ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”.</p>

        <!-- ì…ë ¥ ë¶€ë¶„ -->
        <div class="input-section">
            <h2>1. ê·¸ë˜í”„ ì •ë³´ ì…ë ¥</h2>
            <div class="input-group">
                <label for="graphTitle">ê·¸ë˜í”„ ì œëª©</label>
                <input type="text" id="graphTitle" placeholder="ì˜ˆ: í•œ ë‹¬ ë™ì•ˆì˜ ì‹ë¬¼ í‚¤ ë³€í™”">
            </div>
            <div class="input-group">
                <label for="xAxisLabel">ê°€ë¡œì¶•(Xì¶•) ì´ë¦„</label>
                <input type="text" id="xAxisLabel" placeholder="ì˜ˆ: ë‚ ì§œ">
            </div>
            <div class="input-group">
                <label for="yAxisLabel">ì„¸ë¡œì¶•(Yì¶•) ì´ë¦„</label>
                <input type="text" id="yAxisLabel" placeholder="ì˜ˆ: í‚¤(cm)">
            </div>
            <!-- â˜…â˜…â˜…â˜…â˜… ìƒˆë¡œ ì¶”ê°€ëœ ê¸°ëŠ¥ â˜…â˜…â˜…â˜…â˜… -->
            <div class="input-group">
                <label for="yAxisMin">ì„¸ë¡œì¶• ì‹œì‘ ê°’ (ê·¸ë˜í”„ í•˜ë‹¨ ìƒëµ ê¸°ëŠ¥)</label>
                <input type="number" id="yAxisMin" placeholder="ê°’ì„ ë¹„ì›Œë‘ë©´ 0ë¶€í„° ì‹œì‘í•´ìš”">
            </div>

            <h2>2. ë°ì´í„° ì…ë ¥</h2>
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>í•­ëª© (ê°€ë¡œì¶•)</th>
                        <th>ê°’ (ì„¸ë¡œì¶•)</th>
                    </tr>
                </thead>
                <tbody id="dataBody">
                    <!-- ì˜ˆì‹œ ë°ì´í„° -->
                    <tr>
                        <td><input type="text" class="data-label" value="9ì›”"></td>
                        <td><input type="number" class="data-value" value="85"></td>
                    </tr>
                    <tr>
                        <td><input type="text" class="data-label" value="10ì›”"></td>
                        <td><input type="number" class="data-value" value="80"></td>
                    </tr>
                    <tr>
                        <td><input type="text" class="data-label" value="11ì›”"></td>
                        <td><input type="number" class="data-value" value="105"></td>
                    </tr>
                    <tr>
                        <td><input type="text" class="data-label" value="12ì›”"></td>
                        <td><input type="number" class="data-value" value="90"></td>
                    </tr>
                </tbody>
            </table>
            <div class="button-group">
                <button id="addRowBtn" class="btn-green">â• ë°ì´í„° ì¹¸ ì¶”ê°€í•˜ê¸°</button>
                <button id="removeRowBtn" class="btn-red">â– ë§ˆì§€ë§‰ ë°ì´í„° ì§€ìš°ê¸°</button>
            </div>
        </div>

        <!-- ì‹¤í–‰ ë²„íŠ¼ -->
        <div class="button-group" style="justify-content: center; margin-top: 40px;">
            <button id="drawBtn" style="font-size: 20px; padding: 15px 30px;">ê·¸ë˜í”„ ê·¸ë¦¬ê¸°!</button>
            <button id="downloadBtn" class="btn-green" style="display: none;">ê·¸ë¦¼ìœ¼ë¡œ ì €ì¥í•˜ê¸°</button>
        </div>

        <!-- ê·¸ë˜í”„ê°€ ë‚˜ì˜¤ëŠ” ê³³ -->
        <div class="output-section">
            <canvas id="myChart"></canvas>
        </div>
    </div>

    <script>
        // í•„ìš”í•œ HTML ìš”ì†Œë“¤ì„ ë¯¸ë¦¬ ì°¾ì•„ë‘¡ë‹ˆë‹¤.
        const graphTitleInput = document.getElementById('graphTitle');
        const xAxisLabelInput = document.getElementById('xAxisLabel');
        const yAxisLabelInput = document.getElementById('yAxisLabel');
        const yAxisMinInput = document.getElementById('yAxisMin');
        const dataBody = document.getElementById('dataBody');
        const addRowBtn = document.getElementById('addRowBtn');
        const removeRowBtn = document.getElementById('removeRowBtn');
        const drawBtn = document.getElementById('drawBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const chartCanvas = document.getElementById('myChart');

        let myChart = null; // ê·¸ë˜í”„ë¥¼ ì €ì¥í•  ë³€ìˆ˜

        // 'ë°ì´í„° ì¹¸ ì¶”ê°€í•˜ê¸°' ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ
        addRowBtn.addEventListener('click', function() {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" class="data-label" placeholder="í•­ëª© ì…ë ¥"></td>
                <td><input type="number" class="data-value" placeholder="ìˆ«ì ì…ë ¥"></td>
            `;
            dataBody.appendChild(newRow);
        });

        // 'ë§ˆì§€ë§‰ ë°ì´í„° ì§€ìš°ê¸°' ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ
        removeRowBtn.addEventListener('click', function() {
            const rowCount = dataBody.rows.length;
            if (rowCount > 1) { // ìµœì†Œ 1ê°œì˜ ì¹¸ì€ ë‚¨ê²¨ë‘¡ë‹ˆë‹¤.
                dataBody.deleteRow(rowCount - 1);
            } else {
                alert('ë” ì´ìƒ ì§€ìš¸ ë°ì´í„°ê°€ ì—†ì–´ìš”!');
            }
        });

        // 'ê·¸ë˜í”„ ê·¸ë¦¬ê¸°!' ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ
        drawBtn.addEventListener('click', function() {
            // 1. í‘œì—ì„œ ë°ì´í„° ì½ì–´ì˜¤ê¸°
            const labels = [];
            const dataValues = [];
            const dataRows = dataBody.getElementsByTagName('tr');

            for (let i = 0; i < dataRows.length; i++) {
                const labelInput = dataRows[i].querySelector('.data-label');
                const valueInput = dataRows[i].querySelector('.data-value');

                if (labelInput.value && valueInput.value) {
                    labels.push(labelInput.value);
                    dataValues.push(Number(valueInput.value));
                }
            }
            
            if (labels.length === 0) {
                alert('ê·¸ë˜í”„ë¥¼ ê·¸ë¦´ ë°ì´í„°ê°€ ì—†ì–´ìš”. í‘œì— ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            // 2. ì´ì „ì— ê·¸ë¦° ê·¸ë˜í”„ê°€ ìˆë‹¤ë©´ ì§€ìš°ê¸°
            if (myChart) {
                myChart.destroy();
            }

            // ì„¸ë¡œì¶• ì‹œì‘ ê°’(ìƒëµ ê¸°ëŠ¥)ì„ ì„¤ì •í•©ë‹ˆë‹¤.
            const yAxisOptions = {
                title: {
                    display: true,
                    text: yAxisLabelInput.value || 'ì„¸ë¡œì¶•',
                    font: { size: 16 }
                }
            };
            const yMin = yAxisMinInput.value;
            if (yMin !== '' && !isNaN(yMin)) {
                yAxisOptions.min = Number(yMin);
            } else {
                yAxisOptions.beginAtZero = true;
            }

            // 3. ìƒˆ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
            const ctx = chartCanvas.getContext('2d');
            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: graphTitleInput.value || 'ë‚´ ê·¸ë˜í”„',
                        data: dataValues,
                        borderColor: 'rgba(255, 99, 132, 1)',
                        tension: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: graphTitleInput.value || 'ì œëª© ì—†ëŠ” ê·¸ë˜í”„',
                            font: { size: 20 }
                        },
                        legend: {
                           display: false
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: xAxisLabelInput.value || 'ê°€ë¡œì¶•',
                                font: { size: 16 }
                            },
                            offset: true
                        },
                        y: yAxisOptions
                    }
                }
            });

            downloadBtn.style.display = 'inline-block';
        });

        // 'ê·¸ë¦¼ìœ¼ë¡œ ì €ì¥í•˜ê¸°' ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ
        downloadBtn.addEventListener('click', function() {
            if (!myChart) {
                alert('ì €ì¥í•  ê·¸ë˜í”„ê°€ ì—†ì–´ìš”. ë¨¼ì € ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ì£¼ì„¸ìš”!');
                return;
            }

            const canvas = myChart.canvas;
            const ctx = canvas.getContext('2d');
            
            // â˜…â˜…â˜…â˜…â˜… í•´ê²° ë°©ë²• â˜…â˜…â˜…â˜…â˜…
            // 1. í˜„ì¬ ìº”ë²„ìŠ¤ ìƒíƒœë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
            ctx.save();
            
            // 2. ìº”ë²„ìŠ¤ì— ê·¸ë ¤ì§„ ê·¸ë˜í”„ ë’¤ì— ë°°ê²½ìƒ‰ì„ ì±„ì›ë‹ˆë‹¤.
            ctx.globalCompositeOperation = 'destination-over';
            
            // 3. ë°°ê²½ìƒ‰ì„ í°ìƒ‰(#ffffff)ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
            ctx.fillStyle = '#ffffff';
            
            // 4. ìº”ë²„ìŠ¤ ì „ì²´ë¥¼ í°ìƒ‰ ì‚¬ê°í˜•ìœ¼ë¡œ ì±„ì›ë‹ˆë‹¤.
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // 5. ì €ì¥í–ˆë˜ ìº”ë²„ìŠ¤ ìƒíƒœë¥¼ ë³µì›í•©ë‹ˆë‹¤.
            ctx.restore();
            // â˜…â˜…â˜…â˜…â˜… ì—¬ê¸°ê¹Œì§€ â˜…â˜…â˜…â˜…â˜…

            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png', 1.0);
            link.download = (graphTitleInput.value || 'ë‚˜ì˜_êº¾ì€ì„ ê·¸ë˜í”„') + '.png';
            link.click();
        });
    </script>

</body>
</html>
